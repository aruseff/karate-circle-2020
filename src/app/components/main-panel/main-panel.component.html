<div style="height:100%;margin-left:15px;margin-right:15px;padding-top:10px;background:var(--primary-color-1);">

    <div divLabel title="Signal for">
        <div>
            <label *ngFor="let option of lastSignalOptions; let i=index;" class="checkbox" style="margin-right:20px;">
                <input type="checkbox" value="option.value" [(ngModel)]="workout.lastSignalSelected[i]"
                    class="checkbox" />
                {{option.label}}
            </label>
        </div>
    </div>

    <div class="p-grid" style="height:calc(100% - 33px);">

        <div class="left-panel p-sm-5 p-md-4 p-lg-3">

            <div class="p-grid rounds-delay-panel">
                <div class="p-col-6">
                    <input inputLabel title="Rounds" type="number" min=1 max=20 [(ngModel)]="workout.roundsCount"
                        (input)="refreshWorkoutModel()" onkeydown="return false">
                </div>
                <div class="p-col-6">
                    <input inputLabel title="Delay[s]" type="number" min=1 [(ngModel)]="workout.delay">
                </div>
            </div>

            <div class="p-grid bases-panel">
                <div class="p-col-6" style="padding:0">
                    <p-fieldset legend="Bases" class="no-border">
                        <input *ngFor="let base of workout.basesCount; let i=index; trackBy:trackByIndex;" inputLabel
                            type="number" min=1 [title]="'R' + (i+1)" [marginTop]="'3px'"
                            [(ngModel)]="workout.basesCount[i]" (input)="basesInputChange(i)">
                    </p-fieldset>
                </div>
                <div class="p-col-6" style="padding:0">
                    <p-fieldset legend="Relaxes[s]" class="no-border">
                        <input *ngFor="let relax of workout.relaxes; let i=index; trackBy:trackByIndex;" inputLabel
                            type="number" min=1 [title]="'R' + (i+1) + '&' + (i+2)" [marginTop]="'3px'"
                            [(ngModel)]="workout.relaxes[i]">
                    </p-fieldset>
                </div>
            </div>

            <div class="buttons-panel">
                <p-dropdown [options]="loadedWorkouts" (onChange)="$event.value ? workout = $event.value : ''"
                    class="button-style">
                </p-dropdown>

                <p-button *ngIf="!isWorkoutRunning" label="Start" styleClass="ui-button-secondary" class="button-style"
                    type="button" icon="pi pi-play" iconPos="right"
                    (click)="isWorkoutPaused ? resumeWorkout() : startWorkout()">
                </p-button>

                <p-button *ngIf="isWorkoutRunning" label="Pause" styleClass="ui-button-secondary"
                    class="button-style red-button" type="button" icon="pi pi-pause" iconPos="right"
                    (click)="pauseWorkout()">
                </p-button>

                <p-button label="Reset" styleClass="ui-button-secondary" class="button-style" type="button"
                    icon="pi pi-undo" iconPos="right" [disabled]="isWorkoutRunning" (click)="resetWorkout()">
                </p-button>
                <div class="ui-inputgroup save-workout-button">
                    <input type="text" pInputText placeholder="Workout name" [(ngModel)]="saveWorkoutInput">
                    <p-button icon="pi pi-save" styleClass="ui-button-secondary" (click)="saveWorkout()"></p-button>
                </div>
            </div>

        </div>

        <div class="right-panel p-sm-7 p-md-8 p-lg-9">

            <p-tabView class="rounds-tabs">
                <p-tabPanel *ngFor="let roundTab of workout.rounds; let i=index; trackBy:trackByIndex;"
                    [header]="'Round ' + (i+1)" [selected]="i == 0">

                    <div class="p-grid" style="max-height: 260px;overflow-y: scroll;">
                        <div *ngFor="let inputs of roundTab; let j=index; trackBy:trackByIndex;" class="p-col-4"
                            style="padding: 0.5em 15px;margin-top:10px">
                            <div style="width:50%;float:left;">
                                <label style="display:block;text-align:center;">Worktime
                                    {{j < 9 ? '0'+(j+1) : (j+1)}}[s]</label>
                                <input style="display:block;" class="double-input-field" type="number" min=0
                                    [(ngModel)]="workout.rounds[i][j].workTime">
                            </div>
                            <div style="width:50%;float:left;">
                                <label style="display:block;text-align:center;">Relaxtime
                                    {{j < 9 ? '0'+(j+1) : (j+1)}}[s]</label>
                                <input style="display:block;" class="double-input-field" type="number" min=0
                                    [(ngModel)]="workout.rounds[i][j].relaxTime">
                            </div>
                        </div>
                    </div>

                </p-tabPanel>
            </p-tabView>

            <span style="position:relative;">
                <span class="center-content progress-label" style="left:20px;top:0;">
                    Elapsed Time
                </span>
                <span class="center-content progress-label" style="left:20px;bottom:10px;">
                    {{elapsedTime | minuteSeconds }}
                </span>

                <span class="center-content progress-label" style="right:20px;top:0;">
                    Remaining Time
                </span>
                <span class="center-content progress-label" style="right:20px;bottom:10px;">
                    {{remainingTime | minuteSeconds }}
                </span>
                <p-progressBar class="progress" [value]="progress"></p-progressBar>
            </span>


            <div class="times p-grid" style="margin-top:10px;">

                <div class="p-col-2">
                    <div divLabel class="whole" title="Whole">
                        <span class="center-content">
                            {{whole}}
                        </span>
                    </div>
                </div>

                <div class="p-col-7">
                    <div divLabel class="time p-col-8" title="Time">
                        <span class="center-content">
                            {{currentTime}}
                        </span>
                    </div>
                </div>

                <div class="p-col-3">
                    <div class="round-base p-col-3">
                        <div divLabel class="half-height" title="Round">
                            <span class="center-content">
                                {{currentRound+1}}/{{workout.roundsCount}}
                            </span>
                        </div>
                        <div style="height:4%;"></div>
                        <div divLabel class="half-height" title="Base">
                            <span class="center-content">
                                {{currentBase+1}}/{{workout.rounds[currentRound].length}}
                            </span>
                        </div>
                    </div>
                </div>

            </div>

        </div>
    </div>
</div>

<p-toast></p-toast>
<p-dialog
    [header]="isWorkoutRunning ? 'Relax between ' + (currentRound+1) + ' & ' + (currentRound+2) + ' rounds' : 'Get Ready'"
    [(visible)]="showPrepareDialog" [style]="{width: '23vw', height: '23vw'}" [draggable]="false" [modal]="true"
    [closable]="true" (onHide)="isWorkoutRunning ? relaxDialogOnHide() : prepareDialogOnHide()">
    <div class="center-content" style="width:100%;height:100%;font-size:10vw;font-weight:bold;">
        {{prepareTime}}
    </div>
</p-dialog>